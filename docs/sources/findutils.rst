o=======================
 findutils手册阅读笔记
=======================

.. contents::

Finding Files
=============

文件名匹配
----------

每个文件名匹配的测试命令都有2个版本，用i开头的是忽略大小写的匹配。

- -name、-iname

  匹配文件名，而不匹任何配路径。

- -path、-ipath、-wholename、iwholename

  匹配文件名和路径。-path是通用的，-wholename是GNU的，前者更通用。

  这里的路径是指紧接着find的欲搜索目录到欲搜索文件的相对路径，而不是从根目录开始的绝对路径。
  ::

     $ cd /tmp
     $ mkdir -p foo/bar/baz
     $ find foo -path foo/bar -print
     foo/bar
     $ find foo -path /tmp/foo/bar -print
     $ find /tmp/foo -path /tmp/foo/bar -print
     /tmp/foo/bar

  在匹配包括路径的整个文件名的情况下，*字符会扩展之后可以包括路径和点号，而在shell中*扩展之后不包括。

- -regex、-iregex

  正则表达式匹配，注意匹配的是带路径的整个文件名。

  选项 ``-regextype`` 指定所使用的正则表达式流派，默认的是posix-basic，其它还包括emacs、posix-awk、posix-egrep和posix-extended。

通配符匹配规则
~~~~~~~~~~~~~~

可以用shell的通配符来匹配文件名，需要将其用单引号或者双引号引起来。

*匹配零个或多个任意字符

?匹配单个任意字符

[]匹配其中的任意一个字符。可以在里面用^表示不匹配

\转义

注意在shell中，*不匹配点号和正斜杠，而在find或者locate中它可以匹配。

对搜索到的文件采取的动作
========================

- -print、-fprint FILE

  打印文件名，前者打印到标准输出，后者将文件名输出到file文件中。

- -print0、-fprint0 FILE

  如果某个文件名含有换行符，则不打印那个换行符。

- -ls、-fls FILE、-printf FORMAT、-fprintf FILE FORMAT

  打印文件信息。格式相当于 ``ls -dils` 的格式。

  FORMAT中的可用变量：

    + %p

      文件名，包括相对路径

    + %f

      文件名，不包括路径

    + %h

      路径名

    + %P

      文件名。

    + %H

    + %g

      group name

    + %G

      group ID

    + %u

      file username

    + %U

      user ID

    + %m

      十进制mode bits

    + %M

    + %k

    + %b

      以512字节为单位的磁盘用量

    + %s

      文件大小

    + %S

    + %d

      文件在目录树中的深度，从0开始。

    + %D

    + %F

      文件所在的文件系统。

    + %l

      符号链接的对象，如果文件不是一个符号链接，则为空字符串

    + %i

      inode号

    + %n

      硬链接的数量

    + %y

      文件类型，符号链接的话会显示为 ``l``

    + %Y

      文件类型，会跟踪符号链接，如果是无效的符号链接，则显示 ``N``

    + %a

      最后访问时间，使用C语言的 ``ctime`` 函数返回的格式

    + %AK

      最后访问时间，使用K格式

    + %c

      文件的status最后改变的时间，使用C语言的 ``ctime`` 函数返回的格式

    + %CK

      文件的status最后改变的时间，使用K格式

    + %t

      文件最后改变的时间，使用C语言的 ``ctime`` 函数返回的格式

    + %TK

      文件最后改变的时间，使用K格式

    + %Z

      文件的SELinux上下文，如果没有SELinux上下文的话则为空字符串

    ::

      G U b D k n


Print File Information
----------------------

-ls
-fls file
    用ls -dils命令来打印文件名或者输出到文件。

-printf format
-fprintf file format
    用FORMAT格式打印文件，注意不会打印换行符，可以用\n让它打印。


printf打印格式（没看）
~~~~~~~~~~~~~~~~~~~~~~

Run Commands
------------

Single File
~~~~~~~~~~~

-execdir command ;
-exec command ;

    第一个命令在找到的文件所在目录执行命令，第二个命令会在执行find的目
    录执行命令。第二个命令没有第一个安全。

    需要将{}和;分别用单引号引起来。{}会被替换成文件名。

Multiple Files
~~~~~~~~~~~~~~

-execdir command {} +

Querying
~~~~~~~~

-okdir command ;
-ok command ;

--interactive
-p

    这两个选项让用户确认是否对每个文件执行命令，需要用y或者Y回答。


find
====

符号链接的处理：

-P 从不跟随符号链接，默认值
-L 总是跟随符号链接
-H 如果欲搜索的文件名是一个符号链接，那么仅跟随这个符号链接

-OLEVEL find搜索时的优化级别，值为0-3

locate
======

用法：locate PATTERN

我这里是mlocate。

使用通配符的匹配方式，使PATTERN来匹配由路径和文件名组成文件名全称。
数据库为/var/lib/mlocate/mlocate.db

-b 只匹配文件名，不匹配路径
-c 计数
-d PATH 指定数据库
-e 只打印真正存在的，而不是数据库中有的
-r 用正则表达式匹配，而不是使用通配符匹配
-w 匹配由路径和文件名组成文件名全称，默认
