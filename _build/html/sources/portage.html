

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>portage 软件包管理系统学习笔记 &mdash; funexploit 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="funexploit 1.0 documentation" href="../index.html" />
    <link rel="next" title="python 学习笔记" href="python.html" />
    <link rel="prev" title="Welcome to funexploit’s documentation!" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="python.html" title="python 学习笔记"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Welcome to funexploit’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">funexploit 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="portage">
<h1><a class="toc-backref" href="#id12">portage 软件包管理系统学习笔记</a><a class="headerlink" href="#portage" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#portage" id="id12">portage 软件包管理系统学习笔记</a><ul>
<li><a class="reference internal" href="#id1" id="id13">软件包管理</a><ul>
<li><a class="reference internal" href="#id2" id="id14">安装软件</a></li>
<li><a class="reference internal" href="#id3" id="id15">卸载软件</a></li>
<li><a class="reference internal" href="#id4" id="id16">更新系统</a></li>
<li><a class="reference internal" href="#id5" id="id17">验证软件包的完整性</a></li>
<li><a class="reference internal" href="#id6" id="id18">软件包的依赖关系</a></li>
<li><a class="reference internal" href="#id7" id="id19">查询软件包(普通查询)</a></li>
<li><a class="reference internal" href="#id8" id="id20">查询软件包(高级查询)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9" id="id21">存放目录</a></li>
<li><a class="reference internal" href="#use" id="id22">USE设置</a><ul>
<li><a class="reference internal" href="#id10" id="id23">USE文件的存放目录</a></li>
<li><a class="reference internal" href="#id11" id="id24">查看和操作USE标记</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>根据emerge和equery手册以及gentoo官方文档整理出的一份笔记。</p>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id13">软件包管理</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id14">安装软件</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">安装软件包</p>
<div class="highlight-python"><pre>emerge foo</pre>
</div>
</li>
<li><p class="first">假装安装软件包(&#8211;pretend):</p>
<div class="highlight-python"><pre>emerge -p foo</pre>
</div>
</li>
<li><p class="first">只下载不安装软件包(&#8211;fetchonly)</p>
<div class="highlight-python"><pre>emerge -f foo</pre>
</div>
</li>
<li><p class="first">查看USE标记(&#8211;verbose)</p>
<div class="highlight-python"><pre>emerge -pv foo</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id15">卸载软件</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">卸载软件包(&#8211;unmarge)</p>
<div class="highlight-python"><pre>emerge -C foo</pre>
</div>
</li>
<li><p class="first">卸载不被依赖的软件包(&#8211;depclean)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">emerge</span> <span class="o">-</span><span class="n">c</span>
</pre></div>
</div>
</li>
<li><p class="first">卸载孤立依赖的软件包</p>
<blockquote>
<div><ol class="arabic simple">
<li>用emerge -DNauv更新整个系统</li>
<li>用emerge -c移除孤立的软件包</li>
<li>用revdep-rebuild重建依赖关系</li>
</ol>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id16">更新系统</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>更新portage树</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">emerge</span> <span class="o">--</span><span class="n">sync</span>
</pre></div>
</div>
<p>更新整个系统</p>
<div class="highlight-python"><pre>emerge -DNuva world</pre>
</div>
<p>-D &#8211;deep代表升级world中的软件包及其依赖的所有软件包</p>
<p>-N &#8211;newuse代表用新的USE，在修改了USE的设置后使用</p>
<p>-u代表&#8211;update</p>
<p>-v代表&#8211;verbose</p>
<p>-a代表&#8211;ask</p>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id17">验证软件包的完整性</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>检查软件包foo的完整性(其中的k代表check)</p>
<div class="highlight-python"><pre>equery k foo</pre>
</div>
</div>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id18">软件包的依赖关系</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>直接依赖于foo的所有软件包(其中的d代表depends)</p>
<div class="highlight-python"><pre>equery d foo</pre>
</div>
<p>直接或间接依赖于foo的软件包(g代表depgraph)</p>
<div class="highlight-python"><pre>equery g foo</pre>
</div>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id19">查询软件包(普通查询)</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>根据名称查询软件包(&#8211;search)</p>
<div class="highlight-python"><pre>emerge -s foo</pre>
</div>
<p>正则表达式查询(前面加%)</p>
<div class="highlight-python"><pre>emerge -s '%^emacs'</pre>
</div>
<p>将软件所属类别名称也归入查询范围，需要加个&#8217;%&#64;&#8217;。 emerge -s <a class="reference external" href="mailto:'%&#37;&#52;&#48;app">'%<span>&#64;</span>app</a>.*emacs$&#8217;会查询以app开 头以emacs结尾的软件包，例如app-editors/emacs。</p>
<p>在软件包描述中查询软件(&#8211;searchdesc)</p>
<div class="highlight-python"><pre>emerge -S foo</pre>
</div>
<p>查询已安装的某个文件属于哪个包(belong)</p>
<div class="highlight-python"><pre>equery b /bin/cat</pre>
</div>
<p>查询某个包所安装的文件及其位置(file)</p>
<div class="highlight-python"><pre>equery f foo</pre>
</div>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id20">查询软件包(高级查询)</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>利用 equery list [options] PKG 这种命令格式，使用一些额外的 选项来执行软件包的高级查询。</p>
<p>注意在不使用-f选项时需要全部匹配，例如equery list &#8216;emacs&#8217;只 会匹配名称
为emacs的软件包，而不是名称包括emacs的所有软件包。而如 果使用了-f选项则
不需要全部匹配，例如下例中即不需要用equery list -f &#8216;emacs&#8217;则会匹配名称
包含emacs的所有软件包。</p>
<p>常用选项</p>
<p>-d, &#8211;duplicates
List only packages with more than one version installed.</p>
<p>-f, &#8211;full-regex
The supplied query is a regular expression.</p>
<p>-m, &#8211;mask-reason
Print the reason why a package was masked.</p>
<p>-I, &#8211;exclude-installed
Exclude installed packages from being output.</p>
<p>-o, &#8211;overlay-tree
Include package from overlays in the search path.</p>
<p>-p, &#8211;portage-tree
Include all packages from the Portage tree in the search path. Use this option to search through all standard Gentoo packages, including those that are not installed.</p>
<p>查询系统中安装的所有软件包</p>
<div class="highlight-python"><pre>~# equery l '*'</pre>
</div>
<p>查询系统中安装的两个及以上不同版本的软件包(duplicates)</p>
<div class="highlight-python"><pre>~# equery l -d '*'</pre>
</div>
<p>查询名称为&#8217;emacs&#8217;的软件包</p>
<div class="highlight-python"><pre>~# equery l 'emacs'
* Searching for emacs ...
[IP-] [  ] app-editors/emacs-23.3-r1:23</pre>
</div>
<p>查询名称中包含&#8217;emacs&#8217;的软件包(这里的&#8221;名称&#8221;不包括软件包 所属的类别名称)</p>
<div class="highlight-python"><pre>~# equery l '*emacs*'
 * Searching for *emacs* ...
[IP-] [  ] app-admin/eselect-emacs-1.13:0
[IP-] [  ] app-editors/emacs-23.3-r1:23
[IP-] [  ] app-emacs/emacs-common-gentoo-1.2-r2:0
[IP-] [  ] app-emacs/emacs-w3m-1.4.437_pre20110310:0
[IP-] [  ] virtual/emacs-23:0</pre>
</div>
<p>用正则表达式查询(也在软件包所属的类别名称里搜索)</p>
<div class="highlight-python"><pre>~# equery l -f 'emacs'
 * Searching for emacs ...
[IP-] [  ] app-admin/eselect-emacs-1.13:0
[IP-] [  ] app-editors/emacs-23.3-r1:23
[IP-] [  ] app-emacs/autoconf-mode-2.68:0
[IP-] [  ] app-emacs/color-theme-6.6.0-r1:0
[IP-] [  ] app-emacs/dropdown-list-20090814-r1:0
[IP-] [  ] app-emacs/emacs-common-gentoo-1.2-r2:0
[IP-] [  ] app-emacs/emacs-w3m-1.4.437_pre20110310:0
[IP-] [  ] app-emacs/po-mode-0.18.1.1:0
[IP-] [  ] app-emacs/sawfish-1.32:0
[IP-] [  ] app-emacs/yasnippet-0.6.1c:0
[IP-] [  ] virtual/emacs-23:0
~# equery l -f 'app-admin'
 * Searching for app-admin ...
[IP-] [  ] app-admin/eselect-1.2.15:0
[IP-] [  ] app-admin/eselect-ctags-1.13:0
[IP-] [  ] app-admin/eselect-emacs-1.13:0
[IP-] [  ] app-admin/eselect-fontconfig-1.0:0
[IP-] [  ] app-admin/eselect-mesa-0.0.10:0
[IP-] [  ] app-admin/eselect-opengl-1.2.1:0
[IP-] [  ] app-admin/eselect-python-20100321:0
[IP-] [  ] app-admin/perl-cleaner-2.7:0
[IP-] [  ] app-admin/python-updater-0.9:0</pre>
</div>
<p>在整个portage树里搜索(-p)，包括没有安装的软件包</p>
<p>看看有那些管理工具</p>
<div class="highlight-python"><pre>~# equery l -fp 'app-admin'</pre>
</div>
<p>同上，不包括没有安装的软件包(-I)
看看有那些管理工具没有安装</p>
<div class="highlight-python"><pre>~# equery l -fIp 'app-admin'</pre>
</div>
</div>
</div>
<div class="section" id="id9">
<h2><a class="toc-backref" href="#id21">存放目录</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>portage树存放目录 /usr/portage</li>
<li>已下载软件包的存放目录 /usr/portage/distfiles</li>
<li>明确安装的软件清单 /var/lib/portage/world</li>
</ul>
</div>
<div class="section" id="use">
<h2><a class="toc-backref" href="#id22">USE设置</a><a class="headerlink" href="#use" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id23">USE文件的存放目录</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>全局USE列表 /usr/portage/profiles/use.desc</li>
<li>局部USE列表 /usr/portage/profiles/use.local.desc</li>
</ul>
<p>局部USE列表文件中包含了很长的软件包名单，以及每个软件包 特定的USE标记</p>
<p>USE使用优先级(从低到高)</p>
<ol class="arabic simple">
<li>make.defaults中的USE设定</li>
<li>/etc/make.conf中的USE设定</li>
<li>/etc/protage/package.use中的USE设定</li>
<li>USE环境变量</li>
</ol>
</div>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id24">查看和操作USE标记</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>查看全局USE的最终设定值</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">emerge</span> <span class="o">--</span><span class="n">info</span>
</pre></div>
</div>
<p>查看emacs软件包使用的USE值</p>
<div class="highlight-python"><pre>equery uses emacs</pre>
</div>
<p>使用euse查看USE标记，euse是一个专门查看和设置USE的工具。</p>
<p>查看当前激活的USE标记</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">euse</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
<p>查看当前激活的全局USE标记</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">euse</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">g</span>
</pre></div>
</div>
<p>查看当前激活的局部USE标记</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">euse</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">portage 软件包管理系统学习笔记</a><ul>
<li><a class="reference internal" href="#id1">软件包管理</a><ul>
<li><a class="reference internal" href="#id2">安装软件</a></li>
<li><a class="reference internal" href="#id3">卸载软件</a></li>
<li><a class="reference internal" href="#id4">更新系统</a></li>
<li><a class="reference internal" href="#id5">验证软件包的完整性</a></li>
<li><a class="reference internal" href="#id6">软件包的依赖关系</a></li>
<li><a class="reference internal" href="#id7">查询软件包(普通查询)</a></li>
<li><a class="reference internal" href="#id8">查询软件包(高级查询)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">存放目录</a></li>
<li><a class="reference internal" href="#use">USE设置</a><ul>
<li><a class="reference internal" href="#id10">USE文件的存放目录</a></li>
<li><a class="reference internal" href="#id11">查看和操作USE标记</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../index.html"
                        title="previous chapter">Welcome to funexploit&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="python.html"
                        title="next chapter">python 学习笔记</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/sources/portage.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="python.html" title="python 学习笔记"
             >next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Welcome to funexploit’s documentation!"
             >previous</a> |</li>
        <li><a href="../index.html">funexploit 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, jff.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>